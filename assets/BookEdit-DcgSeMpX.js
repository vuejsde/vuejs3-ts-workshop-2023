import{d as T,e as v,i as w,q as A,c as i,w as q,j as h,v as b,a as l,t as n,y as u,b as x,F as C,o as r}from"./index-ehnKHy1Q.js";import{r as m,m as _}from"./validations-VqEmv7vp.js";const V=l("label",{for:"title"},"Title",-1),N=["aria-invalid"],S={key:0},j=l("label",{for:"author"},"Author",-1),U=["aria-invalid"],z={key:1},M=l("label",{for:"abstract"},"Abstract",-1),D=["aria-invalid"],E={key:2},F=l("button",{type:"submit"},"Submit",-1),I={key:1},$=T({__name:"BookEdit",props:{isbn:{}},setup(g){const d=g,a=v(null),c=v(!1),t=v({title:"",author:"",abstract:""});async function f(e){a.value=null,c.value=!1;const o=await fetch(`https://bookmonkey-read-only.onrender.com/books/${e}`),s=await o.json();o.status===200&&(a.value=s),c.value=!0,p(),y(),k()}w(()=>f(d.isbn)),A(()=>d.isbn,e=>f(e));function B(){Object.keys(t.value).some(e=>t.value[e]!=="")?console.log("Invalid form"):fetch(new Request(`https://bookmonkey-read-only.onrender.com/books/${d.isbn}`,{method:"PUT",body:JSON.stringify(a.value),headers:{"Content-Type":"application/json"}}))}function p(){var e,o;m(((e=a.value)==null?void 0:e.title)??"")?_(((o=a.value)==null?void 0:o.title)??"",5)?t.value.title="":t.value.title="The title must be at least 5 characters long.":t.value.title="Title is required."}function y(){var e;m(((e=a.value)==null?void 0:e.author)??"")?t.value.author="":t.value.author="Author is required."}function k(){var e,o;m(((e=a.value)==null?void 0:e.abstract)??"")?_(((o=a.value)==null?void 0:o.abstract)??"",12)?t.value.abstract="":t.value.abstract="The abstract must be at least 12 characters long.":t.value.abstract="Abstract is required."}return(e,o)=>c.value?(r(),i(C,{key:0},[a.value?(r(),i("form",{key:0,onSubmit:q(B,["prevent"]),novalidate:""},[V,h(l("input",{type:"text",id:"title",name:"title",placeholder:"Book Title","onUpdate:modelValue":o[0]||(o[0]=s=>a.value.title=s),onChange:p,"aria-invalid":t.value.title.length>0},null,40,N),[[b,a.value.title,void 0,{lazy:!0,trim:!0}]]),t.value.title?(r(),i("small",S,n(t.value.title),1)):u("",!0),j,h(l("input",{type:"text",id:"author",name:"author",placeholder:"Book Author","onUpdate:modelValue":o[1]||(o[1]=s=>a.value.author=s),onChange:y,"aria-invalid":t.value.author.length>0},null,40,U),[[b,a.value.author,void 0,{lazy:!0,trim:!0}]]),t.value.author?(r(),i("small",z,n(t.value.author),1)):u("",!0),M,h(l("textarea",{id:"abstract",name:"abstract",placeholder:"Book Abstract","onUpdate:modelValue":o[2]||(o[2]=s=>a.value.abstract=s),onChange:k,"aria-invalid":t.value.abstract.length>0},null,40,D),[[b,a.value.abstract,void 0,{lazy:!0,trim:!0}]]),t.value.abstract?(r(),i("small",E,n(t.value.abstract),1)):u("",!0),F],32)):(r(),i("span",I,[x(" We couldn't find any book with the ISBN "),l("strong",null,n(e.isbn),1)]))],64)):u("",!0)}});export{$ as default};
